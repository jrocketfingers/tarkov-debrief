(this.webpackJsonpdebrief=this.webpackJsonpdebrief||[]).push([[0],{104:function(e,t){},105:function(e,t){},106:function(e,t){},216:function(e,t,c){},217:function(e,t,c){},218:function(e,t,c){},221:function(e,t,c){"use strict";c.r(t);var n=c(3),r=c(0),a=c.n(r),i=c(85),s=c.n(i),o=(c(98),c(55)),u=c.n(o),l=c(86),d=c(7),b=c(19),j=c(23),p=c(92),f=(c(215),c(216),c(217),c(17)),m=(c(218),c.p+"static/media/customs.e4219f37.png"),h=c.p+"static/media/interchange.d1c1fd49.png",v=c.p+"static/media/woods.1db93aa7.png",O=c.p+"static/media/labs.bf97da17.jpg",g=c.p+"static/media/reserve.074ec021.png",x=c.p+"static/media/shoreline.23bac9da.png",C=c.p+"static/media/factory.87c85dcc.jpg",k=c.p+"static/media/customs-thumbnail.b02c6216.png",w=c.p+"static/media/interchange-thumbnail.20071bd5.png",y=c.p+"static/media/woods-thumbnail.70d05156.png",M=c.p+"static/media/labs-thumbnail.b903d684.png",D=c.p+"static/media/reserve-thumbnail.a98054b0.png",N=c.p+"static/media/shoreline-thumbnail.2a773a10.png",P=c.p+"static/media/factory-thumbnail.c6017793.png",A={customs:m,interchange:h,woods:v,labs:O,reserve:g,shoreline:x,factory:C},R={customs:k,interchange:w,woods:y,labs:M,reserve:D,shoreline:N,factory:P};var L,S=function(){return Object(n.jsxs)("div",{className:"MapSelector",children:[Object(n.jsx)("header",{className:"App-header",children:Object(n.jsx)(f.b,{className:"App-header-title",to:"/",children:"Tarkov Debrief"})}),Object(n.jsx)("section",{className:"MapList",children:Object.entries(A).map((function(e){var t=Object(b.a)(e,2),c=t[0];t[1];return Object(n.jsxs)(f.b,{className:"MapList-Card",to:"/app/".concat(c),children:[Object(n.jsx)("img",{src:R[c],alt:"key"}),Object(n.jsx)("p",{children:c})]},c)}))})]})},T=c.p+"static/media/select.a36d8019.svg",B=c.p+"static/media/pencil.6f256236.svg",E=c.p+"static/media/eraser.fa7a8623.svg",I=c.p+"static/media/undo.ccba6760.svg",F=c.p+"static/media/marker.79266f62.svg",Y=c.p+"static/media/save.d3fc937a.svg",z=c.p+"static/media/pmc-thick.e9f45228.svg",K=c.p+"static/media/pmc-med.c746c927.svg",U=c.p+"static/media/pmc-light.62ae8236.svg",X=c.p+"static/media/scav.638c46be.svg",H=c(5),J={width:300,height:300},Z=new Set;var q=["pan"],W={},G="#f00";function Q(e){var t=e.title,c=e.children;return Object(n.jsxs)("div",{className:"sidebar-section",children:[Object(n.jsx)("h1",{className:"sidebar-section-title",children:t}),Object(n.jsx)("div",{className:"sidebar-section-content",children:c})]})}var V=function(){var e=Object(H.f)().map,t=Object(r.useRef)(null),c=Object(r.useRef)(!1),a=Object(r.useState)({type:"pencil",active:!0,onClick:null,onMouseMove:null,cursor:null}),i=Object(b.a)(a,2),s=i[0],o=i[1],m=Object(r.useRef)({type:"pencil",active:!0,onClick:null,onMouseMove:null,cursor:null}),h=Object(r.useRef)({type:"pencil",active:!0,onClick:null,onMouseMove:null,cursor:null}),v=Object(r.useRef)({x:0,y:0}),O=Object(r.useState)(G),g=Object(b.a)(O,2),x=g[0],C=g[1],k=Object(r.useState)(null),w=Object(b.a)(k,2)[1],y=Object(r.useRef)(null),M=Object(r.useRef)(null),D=Object(r.useState)(!1),N=Object(b.a)(D,2),P=N[0],R=N[1],S=Object(r.useCallback)((function(e){if(void 0!==e.target&&m.current.active){if(e.target instanceof j.fabric.Image&&Z.has(e.target.getSrc()))return;M.current.remove(e.target)}}),[]),V=Object(r.useCallback)((function(e){var t=M.current,c=t.viewportTransform;c[4]+=e.e.clientX-v.current.x,c[5]+=e.e.clientY-v.current.y,t.requestRenderAll(),v.current={x:e.e.clientX,y:e.e.clientY}}),[]),$=Object(r.useCallback)((function(e){var t=M.current;"Alt"===e.key&&(c.current=!0,t&&!1===s.active&&(t.isDrawingMode=!1))}),[s]),_=Object(r.useCallback)((function(e){var t=M.current;"Alt"===e.key&&(c.current=!1,t&&"pencil"===s.type&&(t.isDrawingMode=!0))}),[s]),ee=Object(r.useCallback)((function(e){if(M.current){var t=M.current;m.current.onClick&&t.off("mouse:up",m.current.onClick),m.current.onMouseMove&&t.off("mouse:move",m.current.onMouseMove),e.onClick&&t.on("mouse:up",e.onClick),e.onMouseMove&&t.on("mouse:move",e.onMouseMove),null===e.cursor?(t.defaultCursor="auto",t.hoverCursor="auto"):(t.defaultCursor=e.cursor,t.hoverCursor=t.defaultCursor),"pencil"===e.type&&!1===c.current?t.isDrawingMode=!0:t.isDrawingMode=!1}R(!1),o(e),m.current=e}),[]),te=function(e){var t,c=e.target;t=c.src,w(t),y.current=t;var n="url(".concat(c.src,"), auto");ee(Object(d.a)(Object(d.a)({},s),{},{type:"marker",onClick:ce,cursor:n}))},ce=function(){var e=Object(l.a)(u.a.mark((function e(t){var c,n,r,a,i,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y||!y.current){e.next=18;break}if(c=W[y.current]){e.next=8;break}return e.next=5,new Promise((function(e){return j.fabric.Image.fromURL(y.current,e)}));case 5:n=e.sent,W[y.current]=n,c=n;case 8:return e.next=10,new Promise((function(e){return c.clone(e)}));case 10:r=e.sent,a=M.current,i=a.getPointer(t.e),r.left=i.x,r.top=i.y,s=a.getZoom(),r.scale(1/s),a.add(r);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){if(!M.current){var c=function(){var e=new j.fabric.Canvas("canvas",{height:J.height,width:J.width,perPixelTargetFind:!0,selection:!1});return e.freeDrawingBrush.color=G,e.freeDrawingBrush.width=5,e.setCursor("url(".concat(B,")")),e}();M.current=c,j.fabric.Image.fromURL(A[e],(function(e){e.canvas=c,e.selectable=!1,L=e,Z.add(L.getSrc()),c.add(e),c.clearHistory()})),c.on("mouse:down",(function(e){var t=Object(d.a)(Object(d.a)({},m.current),{},{active:!0}),n=e.e;n.altKey&&!m.current.active&&(t.type="pan",t.onMouseMove=V,c.selection=!1,v.current={x:n.clientX,y:n.clientY},h.current=Object(d.a)({},m.current)),ee(t)})),c.on("mouse:up",(function(e){var t=Object(d.a)({},m.current);q.includes(m.current.type)&&(t=Object(d.a)({},h.current)),ee(Object(d.a)(Object(d.a)({},t),{},{active:!1}))})),c.on("mouse:wheel",(function(e){var t=e.e,n=t.deltaY,r=c.getZoom();(r*=Math.pow(.999,n))>20&&(r=20),r<.01&&(r=.01),c.zoomToPoint({x:t.offsetX,y:t.offsetY},r),c.freeDrawingBrush.width=5/r,e.e.preventDefault(),e.e.stopPropagation()}))}function n(){if(t.current){var e,c=t.current.offsetWidth,n=t.current.offsetHeight;null===(e=M.current)||void 0===e||e.setDimensions({width:c,height:n})}else{var r;null===(r=M.current)||void 0===r||r.setDimensions(J)}}return n(),window.addEventListener("resize",n),document.addEventListener("keyup",(function(e){var t=e.key;e.ctrlKey&&"z"===t&&M.current&&M.current.undo()})),function(){window.removeEventListener("resize",n)}}),[t,ee,e,V]),Object(n.jsxs)("div",{className:"App",children:[Object(n.jsxs)("header",{className:"App-header",children:[Object(n.jsx)(f.b,{className:"App-header-title",to:"/",children:"Tarkov Debrief"}),Object(n.jsxs)("section",{className:"App-header-buttons",children:[Object(n.jsx)("button",{onClick:function(){(ee(Object(d.a)(Object(d.a)({},s),{},{type:"select",cursor:null,onClick:null,onMouseMove:null})),M.current)&&(M.current.selection=!0)},children:Object(n.jsx)("img",{src:T,alt:"select"})}),Object(n.jsx)("button",{onClick:function(){ee(Object(d.a)(Object(d.a)({},s),{},{type:"pencil",cursor:null,onClick:null,onMouseMove:null})),M.current},children:Object(n.jsx)("img",{src:B,alt:"pencil"})}),Object(n.jsx)("button",{onClick:function(){(ee(Object(d.a)(Object(d.a)({},s),{},{type:"eraser",cursor:null,onClick:null,onMouseMove:S})),M.current)&&(M.current.selection=!1)},children:Object(n.jsx)("img",{src:E,alt:"eraser"})}),Object(n.jsx)("button",{onClick:function(){M.current&&M.current.undo()},children:Object(n.jsx)("img",{src:I,alt:"undo"})}),Object(n.jsx)("button",{onClick:function(){R(!0)},children:Object(n.jsx)("img",{src:F,alt:"undo"})}),Object(n.jsx)("button",{onClick:function(){M.current&&function(e,t){var c=document.createElement("a");c.download=t,c.href=e,document.body.appendChild(c),c.click(),document.body.removeChild(c)}(M.current.toDataURL({multiplier:3}),"startegy.png")},children:Object(n.jsx)("img",{className:"App-header-buttons-save",src:Y,alt:"save"})})]})]}),Object(n.jsxs)("aside",{className:P?"enter":"",children:[Object(n.jsx)("section",{onClick:function(){R(!1)},id:"closeArea"}),Object(n.jsxs)("section",{id:"sidebar",children:[Object(n.jsxs)(Q,{title:"Markers",children:[Object(n.jsx)("button",{onClick:te,children:Object(n.jsx)("img",{src:z,alt:"thick PMC"})}),Object(n.jsx)("button",{onClick:te,children:Object(n.jsx)("img",{src:K,alt:"medium PMC"})}),Object(n.jsx)("button",{onClick:te,children:Object(n.jsx)("img",{src:U,alt:"light PMC"})}),Object(n.jsx)("button",{onClick:te,children:Object(n.jsx)("img",{src:X,alt:"light PMC"})})]}),Object(n.jsx)(Q,{title:"",children:Object(n.jsx)(p.a,{color:x,triangle:"hide",onChangeComplete:function(e){C(e.hex),M.current&&(M.current.freeDrawingBrush.color=e.hex)}})})]})]}),Object(n.jsx)("div",{className:"Canvas",ref:t,onKeyDown:$,onKeyUp:_,tabIndex:0,children:Object(n.jsx)("canvas",{id:"canvas"})})]})},$=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,223)).then((function(t){var c=t.getCLS,n=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;c(e),n(e),r(e),a(e),i(e)}))};s.a.render(Object(n.jsx)(a.a.StrictMode,{children:Object(n.jsx)(f.a,{children:Object(n.jsxs)(H.c,{children:[Object(n.jsx)(H.a,{path:"/app/:map",children:Object(n.jsx)(V,{})}),Object(n.jsx)(H.a,{path:"/",children:Object(n.jsx)(S,{})})]})})}),document.getElementById("root")),$()},98:function(e,t,c){}},[[221,1,2]]]);
//# sourceMappingURL=main.e1ecc087.chunk.js.map