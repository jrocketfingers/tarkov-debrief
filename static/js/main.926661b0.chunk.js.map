{"version":3,"sources":["maps/customs.png","maps/interchange.png","maps/woods.png","maps/labs.jpg","maps/reserve.png","maps/shoreline.png","maps/factory.jpg","maps/customs-thumbnail.png","maps/interchange-thumbnail.png","maps/woods-thumbnail.png","maps/labs-thumbnail.png","maps/reserve-thumbnail.png","maps/shoreline-thumbnail.png","maps/factory-thumbnail.png","MapSelector.tsx","tools/undo.ts","tools/tool.ts","icons/select.svg","icons/pencil.svg","icons/eraser.svg","icons/undo.svg","icons/marker.svg","icons/save.svg","icons/pmc-thick.svg","icons/pmc-med.svg","icons/pmc-light.svg","icons/scav.svg","tools/select.ts","tools/pencil.ts","tools/eraser.ts","tools/stamp.ts","App.tsx","tools/zoom.ts","reportWebVitals.ts","index.tsx"],"names":["maps","customs","interchange","woods","labs","reserve","shoreline","factory","thumbnails","customsThumbnail","interchangeThumbnail","woodsThumbnail","labsThumbnail","reserveThumbnail","shorelineThumbnail","factoryThumbnail","MapSelector","canvas","ToolType","className","to","Object","entries","map","key","src","alt","keyboardListener","event","ctrlKey","undo","onUse","onChoice","tool","setTool","maybeCanvas","setColor","unerasable","setSidebar","markerUrl","backgroundImage","type","select","cursor","pencil","onColorChoice","color","hex","freeDrawingBrush","active","eraser","opt","undefined","target","fabric","Image","has","getSrc","remove","onClick","onRelease","markerCache","evt","cursorString","defaultCursor","hoverCursor","marker","placeMarker","a","e","altKey","cachedImage","Promise","resolve","fromURL","newImage","clone","image","pointer","getPointer","left","x","top","y","zoom","getZoom","scale","add","defaultSize","width","height","Set","PENCIL_COLOR","SidebarSection","title","children","App","useParams","containerRef","useRef","appRef","useState","console","log","canvasInstance","setToolOuter","setCanvas","sidebar","setSelect","useEffect","selection","toolOuter","setColorOuter","isDrawingMode","usePencil","setPencil","setEraser","unerasableOuter","on","off","useEraser","appEl","current","addEventListener","removeEventListener","useUndo","selectMarker","setSidebarOuter","useStamp","brushWidth","delta","deltaY","zoomToPoint","offsetX","offsetY","preventDefault","stopPropagation","useZoom","Canvas","perPixelTargetFind","setCursor","pencilIcon","initializeCanvas","imageInstance","selectable","clearHistory","resizeListener","window","offsetWidth","offsetHeight","setDimensions","ref","selectIcon","eraserIcon","undoIcon","addMarkerIcon","url","name","link","document","createElement","download","href","body","appendChild","click","removeChild","startDownload","toDataURL","multiplier","saveIcon","id","thickPMCMarker","mediumPMCMarker","lightPMCMarker","scavMarker","triangle","onChangeComplete","tabIndex","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactGA","initialize","pageview","location","pathname","search","ReactDOM","render","StrictMode","basename","path","getElementById"],"mappings":"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","file":"static/js/main.926661b0.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/customs.e4219f37.png\";","export default __webpack_public_path__ + \"static/media/interchange.d1c1fd49.png\";","export default __webpack_public_path__ + \"static/media/woods.1db93aa7.png\";","export default __webpack_public_path__ + \"static/media/labs.bf97da17.jpg\";","export default __webpack_public_path__ + \"static/media/reserve.074ec021.png\";","export default __webpack_public_path__ + \"static/media/shoreline.23bac9da.png\";","export default __webpack_public_path__ + \"static/media/factory.87c85dcc.jpg\";","export default __webpack_public_path__ + \"static/media/customs-thumbnail.b02c6216.png\";","export default __webpack_public_path__ + \"static/media/interchange-thumbnail.20071bd5.png\";","export default __webpack_public_path__ + \"static/media/woods-thumbnail.70d05156.png\";","export default __webpack_public_path__ + \"static/media/labs-thumbnail.b903d684.png\";","export default __webpack_public_path__ + \"static/media/reserve-thumbnail.a98054b0.png\";","export default __webpack_public_path__ + \"static/media/shoreline-thumbnail.2a773a10.png\";","export default __webpack_public_path__ + \"static/media/factory-thumbnail.c6017793.png\";","import React from 'react';\nimport { Link } from 'react-router-dom';\n\nimport \"./MapSelector.css\";\n\nimport customs from \"./maps/customs.png\";\nimport interchange from \"./maps/interchange.png\";\nimport woods from \"./maps/woods.png\";\nimport labs from \"./maps/labs.jpg\";\nimport reserve from \"./maps/reserve.png\";\nimport shoreline from \"./maps/shoreline.png\";\nimport factory from \"./maps/factory.jpg\";\n\nimport customsThumbnail from \"./maps/customs-thumbnail.png\";\nimport interchangeThumbnail from \"./maps/interchange-thumbnail.png\";\nimport woodsThumbnail from \"./maps/woods-thumbnail.png\";\nimport labsThumbnail from \"./maps/labs-thumbnail.png\";\nimport reserveThumbnail from \"./maps/reserve-thumbnail.png\";\nimport shorelineThumbnail from \"./maps/shoreline-thumbnail.png\";\nimport factoryThumbnail from \"./maps/factory-thumbnail.png\";\n\nexport const maps: Record<string, string> = {customs, interchange, woods, labs, reserve, shoreline, factory};\nexport const thumbnails: Record<string, string> = {\n  customs: customsThumbnail,\n  interchange: interchangeThumbnail,\n  woods: woodsThumbnail,\n  labs: labsThumbnail,\n  reserve: reserveThumbnail,\n  shoreline: shorelineThumbnail,\n  factory: factoryThumbnail,\n};\n\nfunction MapSelector() {\n  return (\n    <div className=\"MapSelector\">\n      <header className=\"App-header\">\n        <Link className=\"App-header-title\" to=\"/\">Tarkov Debrief</Link>\n      </header>\n      <section className=\"MapList\">\n        {Object.entries(maps).map(([key, value]) => \n          <Link key={key} className=\"MapList-Card\" to={`/app/${key}`}>\n            <img src={thumbnails[key]} alt=\"key\"/>\n            <p>{key}</p>\n          </Link>\n        )}\n      </section>\n    </div>\n  )\n}\n\nexport default MapSelector;","import { fabric } from 'fabric';\nimport { RefObject, useEffect } from 'react';\n\nlet canvas: fabric.Canvas | null;\n\nconst keyboardListener = (event: KeyboardEvent) => {\n  if (event.ctrlKey && event.key === \"z\") {\n    canvas?.undo();\n  }\n}\n\nexport const onUse = () => {\n  canvas?.undo();\n}\n\nexport const onChoice = () => {\n  onUse();\n}\n\nexport const useUndo = (canvasInstance: fabric.Canvas | null, appRef: RefObject<HTMLDivElement>) => {\n  canvas = canvasInstance;\n\n  useEffect(() => {\n    const appEl = appRef.current;\n    appEl?.addEventListener(\"keydown\", keyboardListener);\n\n    return () => {\n      appEl?.removeEventListener(\"keydown\", keyboardListener);\n    }\n  }, [appRef]);\n  return { onUse, onChoice };\n}\n","export enum ToolType {\n  select = \"select\",\n  pencil = \"pencil\",\n  eraser = \"eraser\",\n  marker = \"marker\",\n  pan = \"pan\",\n}\n\nexport type Tool = {\n  active: boolean;\n  type: ToolType;\n  cursor: null | string;\n};\n\nexport type SetToolFn = (tool: Tool) => void;\n","export default __webpack_public_path__ + \"static/media/select.a36d8019.svg\";","export default __webpack_public_path__ + \"static/media/pencil.6f256236.svg\";","export default __webpack_public_path__ + \"static/media/eraser.fa7a8623.svg\";","export default __webpack_public_path__ + \"static/media/undo.ccba6760.svg\";","export default __webpack_public_path__ + \"static/media/marker.79266f62.svg\";","export default __webpack_public_path__ + \"static/media/save.d3fc937a.svg\";","export default __webpack_public_path__ + \"static/media/pmc-thick.e7585799.svg\";","export default __webpack_public_path__ + \"static/media/pmc-med.bd966230.svg\";","export default __webpack_public_path__ + \"static/media/pmc-light.10d08880.svg\";","export default __webpack_public_path__ + \"static/media/scav.c41c1ff5.svg\";","import { fabric } from \"fabric\";\nimport { useEffect } from \"react\";\nimport { Tool, ToolType, SetToolFn } from './tool';\n\nlet canvas: fabric.Canvas | null;\nlet tool: Tool;\nlet setTool: SetToolFn;\n\nexport const onChoice = () => {\n  setTool({\n    ...tool,\n    type: ToolType.select,\n    cursor: null,\n  });\n}\n\nexport const useSelect = (canvasInstance: fabric.Canvas | null, setToolOuter: SetToolFn, toolOuter: Tool) => {\n  canvas = canvasInstance;\n  setTool = setToolOuter;\n  tool = toolOuter;\n\n  useEffect(() => {\n    if(tool.type === ToolType.select && canvas) {\n      canvas.selection = true;\n\n      return () => {\n        if(canvas) canvas.selection = false;\n      };\n    }\n  }, [tool, setToolOuter, canvasInstance]);\n\n  return { onChoice };\n};","import { fabric } from \"fabric\";\nimport { useEffect } from \"react\";\nimport { ColorResult } from \"react-color\";\nimport { Tool, ToolType, SetToolFn } from \"./tool\";\n\nlet maybeCanvas: fabric.Canvas | null;\nlet tool: Tool;\nlet setTool: SetToolFn;\nlet setColor: (color: string) => void;\n\nexport const onChoice = () => {\n  setTool({\n    ...tool,\n    type: ToolType.pencil,\n    cursor: null,\n  });\n};\n\nconst onColorChoice = (color: ColorResult) => {\n  if (!maybeCanvas) return;\n  const canvas = maybeCanvas!;\n\n  setColor(color.hex);\n  if (canvas) {\n    canvas.freeDrawingBrush.color = color.hex;\n  }\n};\n\nexport const usePencil = (\n  canvas: fabric.Canvas | null,\n  setToolOuter: SetToolFn,\n  toolOuter: Tool,\n  setColorOuter: (color: string) => void\n) => {\n  maybeCanvas = canvas;\n  setTool = setToolOuter;\n  tool = toolOuter;\n  setColor = setColorOuter;\n\n  useEffect(() => {\n    if (toolOuter.type === ToolType.pencil && maybeCanvas) {\n      maybeCanvas.isDrawingMode = true;\n\n      return () => {\n        if (maybeCanvas) maybeCanvas.isDrawingMode = false;\n      };\n    }\n  }, [toolOuter, canvas]);\n\n  return { onChoice, onColorChoice };\n};\n","import { fabric } from \"fabric\";\nimport { IEvent } from \"fabric/fabric-impl\";\nimport { useEffect } from \"react\";\nimport { SetToolFn, Tool, ToolType } from \"./tool\";\n\nlet maybeCanvas: fabric.Canvas | null;\nlet tool: Tool;\nlet setTool: SetToolFn;\nlet unerasable: Set<string>;\nlet active = false;\n\nexport const onChoice = () => {\n  setTool({\n    ...tool,\n    type: ToolType.eraser,\n    cursor: null,\n  });\n}\n\nexport const onUse = (opt: IEvent) => {\n  if (tool.type === ToolType.eraser && opt.target !== undefined && active) {\n    if (\n      opt.target instanceof fabric.Image &&\n      unerasable.has(opt.target.getSrc())\n    )\n      return;\n    maybeCanvas?.remove(opt.target!);\n  }\n}\n\nconst onClick = () => {\n  active = true;\n}\n\nconst onRelease = () => {\n  active = false;\n}\n\nexport const useEraser = (canvas: fabric.Canvas | null, setToolOuter: SetToolFn, toolOuter: Tool, unerasableOuter: Set<string>) => {\n  maybeCanvas = canvas;\n  setTool = setToolOuter;\n  tool = toolOuter;\n  unerasable = unerasableOuter;\n\n  useEffect(() => {\n    if(tool.type === ToolType.eraser && maybeCanvas) {\n      maybeCanvas.on(\"mouse:move\", onUse);\n      maybeCanvas.on(\"mouse:down\", onClick);\n      maybeCanvas.on(\"mouse:up\", onRelease);\n      maybeCanvas.selection = false;\n\n      return () => {\n        if(maybeCanvas) {\n          maybeCanvas.off(\"mouse:move\", onUse);\n          maybeCanvas.off(\"mouse:move\", onClick);\n          maybeCanvas.off(\"mouse:move\", onRelease);\n          active = false;\n        }\n      };\n    }\n  }, [toolOuter, canvas]);\n\n  return { onChoice, onUse };\n};","/* Stamp tool places a marker -- scav icon, pmc icon, etc */\n\nimport { fabric } from \"fabric\";\nimport { IEvent } from \"fabric/fabric-impl\";\nimport { useEffect } from \"react\";\nimport { SetToolFn, Tool, ToolType } from \"./tool\";\n\nlet setTool: SetToolFn;\nlet tool: Tool;\nlet setSidebar: (visible: boolean) => void;\nlet markerUrl: string;\nlet maybeCanvas: fabric.Canvas | null;\nconst markerCache: Record<string, fabric.Image> = {};\n\nexport const onChoice = (\n  evt: React.MouseEvent<HTMLButtonElement, MouseEvent>\n) => {\n  const target = evt.target as HTMLImageElement;\n  markerUrl = target.src;\n  const cursorString = `url(${markerUrl}), auto`;\n\n  if (maybeCanvas) {\n    maybeCanvas.defaultCursor = cursorString;\n    maybeCanvas.hoverCursor = cursorString;\n  }\n\n  setTool({ ...tool, type: ToolType.marker })\n\n  setSidebar(false);\n};\n\nconst placeMarker = async (evt: IEvent) => {\n  if (!maybeCanvas) return;\n  const canvas = maybeCanvas!;\n\n  if ((evt.e as MouseEvent).altKey) return;\n\n  let cachedImage = markerCache[markerUrl];\n  if (!cachedImage) {\n    const newImage: fabric.Image = await new Promise((resolve) =>\n      fabric.Image.fromURL(markerUrl, resolve)\n    );\n    markerCache[markerUrl] = newImage;\n    cachedImage = newImage;\n  }\n\n  const image: fabric.Image = await new Promise((resolve) =>\n    cachedImage.clone(resolve)\n  );\n\n  const pointer = canvas.getPointer(evt.e);\n  image.left = pointer.x;\n  image.top = pointer.y;\n\n  const zoom = canvas.getZoom();\n  image.scale(1 / zoom);\n\n  canvas.add(image);\n};\n\n\nexport const useStamp = (\n  canvas: fabric.Canvas | null,\n  setSidebarOuter: (visible: boolean) => void,\n  toolOuter: Tool,\n  setToolOuter: SetToolFn,\n) => {\n  tool = toolOuter;\n  setTool = setToolOuter;\n  setSidebar = setSidebarOuter;\n  maybeCanvas = canvas;\n\n  useEffect(() => {\n    if (canvas && toolOuter.type === ToolType.marker) {\n      canvas.on('mouse:down', placeMarker);\n\n      return () => {\n        canvas.off('mouse:down', placeMarker);\n        canvas.defaultCursor = 'auto';\n        canvas.hoverCursor = 'auto';\n      }\n    }\n  }, [toolOuter, canvas]);\n\n  return { onChoice };\n};","import React, { useEffect, useRef, useState } from \"react\";\nimport { fabric } from \"fabric\";\nimport { TwitterPicker } from \"react-color\";\nimport { Link, useParams } from \"react-router-dom\";\nimport \"fabric-history\";\nimport \"./App.css\";\nimport \"./Sidebar.css\";\n\nimport { maps } from \"./MapSelector\";\n\nimport selectIcon from \"./icons/select.svg\";\nimport pencilIcon from \"./icons/pencil.svg\";\nimport eraserIcon from \"./icons/eraser.svg\";\nimport undoIcon from \"./icons/undo.svg\";\nimport addMarkerIcon from \"./icons/marker.svg\";\nimport saveIcon from \"./icons/save.svg\";\n\nimport { useUndo } from \"./tools/undo\";\n\nimport thickPMCMarker from \"./icons/pmc-thick.svg\";\nimport mediumPMCMarker from \"./icons/pmc-med.svg\";\nimport lightPMCMarker from \"./icons/pmc-light.svg\";\nimport scavMarker from \"./icons/scav.svg\";\nimport { Tool, ToolType } from \"./tools/tool\";\nimport { useSelect } from \"./tools/select\";\nimport { usePencil } from \"./tools/pencil\";\nimport { useEraser } from \"./tools/eraser\";\nimport { useStamp } from \"./tools/stamp\";\nimport { useZoom } from \"./tools/zoom\";\n\ntype Size = { width: number; height: number };\n\nconst defaultSize: Size = { width: 300, height: 300 };\nlet backgroundImage: fabric.Image;\nlet unerasable = new Set<string>();\n\nfunction startDownload(url: string, name: string): void {\n  const link = document.createElement(\"a\");\n  link.download = name;\n  link.href = url;\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n}\n\nconst brushWidth = 5;\nconst PENCIL_COLOR: string = \"#f00\";\n\nfunction initializeCanvas() {\n  const canvas = new fabric.Canvas(\"canvas\", {\n    height: defaultSize.height,\n    width: defaultSize.width,\n    isDrawingMode: true,\n    perPixelTargetFind: true,\n    selection: false,\n  });\n\n  canvas.freeDrawingBrush.color = PENCIL_COLOR;\n  canvas.freeDrawingBrush.width = brushWidth;\n\n  canvas.setCursor(`url(${pencilIcon})`);\n\n  return canvas;\n}\n\ninterface SidebarSectionProps {\n  title: string;\n  children: React.ReactNode;\n}\n\nfunction SidebarSection({ title, children }: SidebarSectionProps) {\n  return (\n    <div className=\"sidebar-section\">\n      <h1 className=\"sidebar-section-title\">{title}</h1>\n      <div className=\"sidebar-section-content\">{children}</div>\n    </div>\n  );\n}\n\ninterface Params {\n  map: string;\n}\n\nfunction App() {\n  const { map } = useParams<Params>();\n  const containerRef = useRef<HTMLDivElement>(null);\n  const appRef = useRef<HTMLDivElement>(null);\n  const [tool, setTool] = useState<Tool>({\n    type: ToolType.pencil,\n    active: false,\n    cursor: null,\n  });\n\n  console.log(\"rerender\");\n\n  const [color, setColor] = useState<string>(PENCIL_COLOR);\n  const [maybeCanvas, setCanvas] = useState<fabric.Canvas | null>(null);\n  const [sidebar, setSidebar] = useState<boolean>(false);\n\n  const save = () => {\n    if (maybeCanvas) {\n      const url = maybeCanvas.toDataURL({ multiplier: 3 });\n      startDownload(url, \"startegy.png\");\n    }\n  };\n\n  const { onChoice: setSelect } = useSelect(maybeCanvas, setTool, tool);\n\n  const { onChoice: setPencil, onColorChoice } = usePencil(\n    maybeCanvas,\n    setTool,\n    tool,\n    setColor\n  );\n\n  const { onChoice: setEraser } = useEraser(\n    maybeCanvas,\n    setTool,\n    tool,\n    unerasable\n  );\n\n  const { onUse: undo } = useUndo(maybeCanvas, appRef);\n\n  const { onChoice: selectMarker } = useStamp(\n    maybeCanvas,\n    setSidebar,\n    tool,\n    setTool\n  );\n\n  // FIXME: untie zoom tool from brush\n  useZoom(maybeCanvas, brushWidth);\n\n  const showSidebar = () => {\n    setSidebar(true);\n  };\n\n  const hideSidebar = () => {\n    setSidebar(false);\n  };\n\n  // Run-once\n  useEffect(() => {\n    setCanvas(initializeCanvas());\n  }, []);\n\n  // Load map and ensure it's fullscreen\n  useEffect(() => {\n    let image: fabric.Image;\n\n    if (!maybeCanvas) return;\n    const canvas = maybeCanvas!;\n\n    fabric.Image.fromURL(maps[map], (imageInstance) => {\n      image = imageInstance;\n      image.canvas = canvas;\n      image.selectable = false;\n      backgroundImage = image;\n      unerasable.add(backgroundImage.getSrc());\n      canvas.add(image);\n      canvas.clearHistory();\n    });\n\n    function resizeListener() {\n      if (containerRef.current) {\n        const width = containerRef.current.offsetWidth;\n        const height = containerRef.current.offsetHeight;\n        maybeCanvas?.setDimensions({ width, height });\n      } else {\n        maybeCanvas?.setDimensions(defaultSize);\n      }\n    }\n\n    resizeListener();\n\n    window.addEventListener(\"resize\", resizeListener);\n    return () => {\n      window.removeEventListener(\"resize\", resizeListener);\n    };\n  }, [map, maybeCanvas]);\n\n  return (\n    <div className=\"App\" ref={appRef}>\n      <header className=\"App-header\">\n        <Link className=\"App-header-title\" to=\"/\">\n          Tarkov Debrief\n        </Link>\n        <section className=\"App-header-buttons\">\n          <button onClick={setSelect}>\n            <img src={selectIcon} alt=\"select\" />\n          </button>\n          <button onClick={setPencil}>\n            <img src={pencilIcon} alt=\"pencil\" />\n          </button>\n          <button onClick={setEraser}>\n            <img src={eraserIcon} alt=\"eraser\" />\n          </button>\n          <button onClick={undo}>\n            <img src={undoIcon} alt=\"undo\" />\n          </button>\n          <button onClick={showSidebar}>\n            <img src={addMarkerIcon} alt=\"undo\" />\n          </button>\n          <button onClick={save}>\n            <img\n              className=\"App-header-buttons-save\"\n              src={saveIcon}\n              alt=\"save\"\n            />\n          </button>\n        </section>\n      </header>\n      <aside className={sidebar ? \"enter\" : \"\"}>\n        <section onClick={hideSidebar} id=\"closeArea\"></section>\n        <section id=\"sidebar\">\n          <SidebarSection title=\"Markers\">\n            <button onClick={selectMarker}>\n              <img src={thickPMCMarker} alt=\"thick PMC\" />\n            </button>\n            <button onClick={selectMarker}>\n              <img src={mediumPMCMarker} alt=\"medium PMC\" />\n            </button>\n            <button onClick={selectMarker}>\n              <img src={lightPMCMarker} alt=\"light PMC\" />\n            </button>\n            <button onClick={selectMarker}>\n              <img src={scavMarker} alt=\"light PMC\" />\n            </button>\n          </SidebarSection>\n          <SidebarSection title=\"\">\n            <TwitterPicker\n              color={color}\n              triangle=\"hide\"\n              onChangeComplete={onColorChoice}\n            ></TwitterPicker>\n          </SidebarSection>\n        </section>\n      </aside>\n      <div className=\"Canvas\" ref={containerRef} tabIndex={0}>\n        <canvas id=\"canvas\"></canvas>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import { fabric } from \"fabric\";\nimport { useEffect } from \"react\";\n\nexport const useZoom = (canvasInstance: fabric.Canvas | null, brushWidth: number) => {\n  useEffect(() => {\n    if (!canvasInstance) return;\n    const canvas = canvasInstance!;\n\n    /* zoom */\n    canvas.on(\"mouse:wheel\", function (opt) {\n      const event = opt.e as WheelEvent;\n      const delta = event.deltaY;\n      let zoom = canvas.getZoom();\n      zoom *= 0.999 ** delta;\n      if (zoom > 20) zoom = 20;\n      if (zoom < 0.01) zoom = 0.01;\n      canvas.zoomToPoint(\n        { x: event.offsetX, y: event.offsetY } as fabric.Point,\n        zoom\n      );\n      canvas.freeDrawingBrush.width = brushWidth / zoom;\n      opt.e.preventDefault();\n      opt.e.stopPropagation();\n    });\n  }, [brushWidth, canvasInstance]);\n};","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport ReactGA from 'react-ga';\nimport './index.css';\nimport App from './App';\nimport MapSelector from './MapSelector';\nimport reportWebVitals from './reportWebVitals';\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n} from \"react-router-dom\";\n\nReactGA.initialize('UA-189112106-1');\nReactGA.pageview(window.location.pathname + window.location.search);\n\nReactDOM.render(\n  <React.StrictMode>\n    <Router basename=\"/tarkov-debrief\">\n      <Switch>\n        <Route path=\"/app/:map\">\n          <App />\n        </Route>\n        <Route path=\"/\">\n          <MapSelector />\n        </Route>\n      </Switch>\n    </Router>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}